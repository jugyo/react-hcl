import type { TerraformTypeSchema } from "../../types";
import { COMMON_RESOURCE_ATTRIBUTES, COMMON_RESOURCE_BLOCKS } from "./common";

// Source: https://developer.hashicorp.com/terraform/providers/hashicorp/aws/latest/docs/resources/db_instance
export const awsDbInstanceResourceSchema = {
  kind: "resource",
  type: "aws_db_instance",
  attributes: {
    ...COMMON_RESOURCE_ATTRIBUTES,
    address: { valueType: "string", computed: true },
    allocated_storage: { valueType: "number", optional: true },
    allow_major_version_upgrade: { valueType: "bool", optional: true },
    apply_immediately: { valueType: "bool", optional: true },
    arn: { valueType: "string", computed: true },
    auto_minor_version_upgrade: { valueType: "bool", optional: true },
    availability_zone: { valueType: "string", optional: true },
    backup_retention_period: { valueType: "number", optional: true },
    backup_target: { valueType: "string", optional: true },
    backup_window: { valueType: "string", optional: true },
    ca_cert_identifier: { valueType: "string", optional: true },
    character_set_name: { valueType: "string", optional: true },
    copy_tags_to_snapshot: { valueType: "bool", optional: true },
    db_name: { valueType: "string", optional: true },
    db_subnet_group_name: { valueType: "string", optional: true },
    dedicated_log_volume: { valueType: "bool", optional: true },
    deletion_protection: { valueType: "bool", optional: true },
    engine: { valueType: "string", optional: true },
    engine_lifecycle_support: { valueType: "string", optional: true },
    engine_version: { valueType: "string", optional: true },
    final_snapshot_identifier: { valueType: "string", optional: true },
    iam_database_authentication_enabled: { valueType: "bool", optional: true },
    identifier: { valueType: "string", optional: true },
    identifier_prefix: { valueType: "string", optional: true },
    instance_class: { valueType: "string", required: true },
    iops: { valueType: "number", optional: true },
    kms_key_id: { valueType: "string", optional: true },
    license_model: { valueType: "string", optional: true },
    maintenance_window: { valueType: "string", optional: true },
    manage_master_user_password: { valueType: "bool", optional: true },
    master_user_secret_kms_key_id: { valueType: "string", optional: true },
    max_allocated_storage: { valueType: "number", optional: true },
    monitoring_interval: { valueType: "number", optional: true },
    monitoring_role_arn: { valueType: "string", optional: true },
    multi_az: { valueType: "bool", optional: true },
    network_type: { valueType: "string", optional: true },
    option_group_name: { valueType: "string", optional: true },
    parameter_group_name: { valueType: "string", optional: true },
    password: { valueType: "string", optional: true, sensitive: true },
    password_wo: { valueType: "string", optional: true, sensitive: true },
    performance_insights_enabled: { valueType: "bool", optional: true },
    performance_insights_kms_key_id: { valueType: "string", optional: true },
    performance_insights_retention_period: {
      valueType: "number",
      optional: true,
    },
    port: { valueType: "number", optional: true },
    publicly_accessible: { valueType: "bool", optional: true },
    replica_mode: { valueType: "string", optional: true },
    replicate_source_db: { valueType: "string", optional: true },
    skip_final_snapshot: { valueType: "bool", optional: true },
    snapshot_identifier: { valueType: "string", optional: true },
    status: { valueType: "string", computed: true },
    storage_encrypted: { valueType: "bool", optional: true },
    storage_throughput: { valueType: "number", optional: true },
    storage_type: { valueType: "string", optional: true },
    tags: { valueType: "map", optional: true },
    tags_all: { valueType: "map", computed: true },
    username: { valueType: "string", optional: true },
    vpc_security_group_ids: { valueType: "set", optional: true },
  },
  blocks: {
    ...COMMON_RESOURCE_BLOCKS,
    blue_green_update: {
      nestingMode: "single",
      attributes: {
        enabled: { valueType: "bool", optional: true },
      },
    },
    restore_to_point_in_time: {
      nestingMode: "single",
      attributes: {
        restore_time: { valueType: "string", optional: true },
        source_db_instance_automated_backups_arn: {
          valueType: "string",
          optional: true,
        },
        source_db_instance_identifier: { valueType: "string", optional: true },
        source_dbi_resource_id: { valueType: "string", optional: true },
        use_latest_restorable_time: { valueType: "bool", optional: true },
      },
    },
    s3_import: {
      nestingMode: "single",
      attributes: {
        bucket_name: { valueType: "string", required: true },
        bucket_prefix: { valueType: "string", optional: true },
        ingestion_role: { valueType: "string", required: true },
        source_engine: { valueType: "string", required: true },
        source_engine_version: { valueType: "string", required: true },
      },
    },
    timeouts: {
      nestingMode: "single",
      attributes: {
        create: { valueType: "string", optional: true },
        update: { valueType: "string", optional: true },
        delete: { valueType: "string", optional: true },
      },
    },
  },
} as const satisfies TerraformTypeSchema;
